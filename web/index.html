<!doctype html>
<link rel="stylesheet" href="node_modules/leaflet/dist/leaflet.css"/>
<script src="node_modules/leaflet/dist/leaflet.js"></script>
<style>
html, body { padding: 0; margin: 0; }
html, body, #map { height: 100% }
.text-label span {
    color: black;
    background: white;
    padding: 2px 4px;
    border-radius: 3px;
    font-size: 12px;
    white-space: nowrap;
    box-shadow: 0 0 2px rgba(0,0,0,0.5);
}
.circle-text span {
    color: white;
    font-size: 14px;
    font-weight: bold;
    text-align: center;
    display: block;
    transform: translate(-50%, -50%);
    position: absolute;
    top: 50%;
    left: 50%;
}
</style>
<div id="map"></div>
<script src="data.js"></script>
<script>
var map = L.map('map').setView([44.0994213,-120.6629185], 7);
L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19,
    attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
}).addTo(map);

for (const s of DATA) {
  if (!s.lat) continue;
  const score = s.subjects?.english;
  if (!score) continue;

  const circle = L.circle([s.lat, s.long], {
      color: 'none',
      fillColor: `hsl(${score} 100% 40%)`,
      fillOpacity: 0.8,
      radius: 500
  }).addTo(map).bindPopup(`${s.name}`);

  const text = L.marker([s.lat, s.long], {
      icon: L.divIcon({
          className: 'circle-text',
          html: `<span>${score.toFixed(0)}</span>`,
      }),
      interactive: false
  }).addTo(map);
}
</script>
